# 045-Redis分布式方案-RedisCluster-重新分片

[TOC]

## 什么是Redis重新分片

Redis集群的重新分片操作可以将任意数量已经指派给某个节点的槽改为其他节点

## 数据迁移

因为 key 和 slot 的关系是永远不会变的，当新增了节点的时候，需要把原有的 slot 分配给新的节点负责，并且把相关的数据迁移过来。

添加新节点(新增一个 7297):

```
redis-cli --cluster add-node 127.0.0.1:7291 127.0.0.1:7297
```

新增的节点没有哈希槽，不能分布数据，在原来的任意一个节点上执行:

```
redis-cli --cluster reshard 127.0.0.1:7291
```

输入需要分配的哈希槽的数量(比如 500)，和哈希槽的来源节点(可以输入 all 或者 id)。

问题： **只有主节点可以写，一个主节点挂了，从节点怎么变成主节点?**