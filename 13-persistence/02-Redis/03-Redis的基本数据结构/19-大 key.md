## Redis 中的 大key

有时候 Redis 使用不当,会形成一个非常大的 hash或者很大的 zset, 这种 key 就属于大 key

大 key 在进行集群数据迁移的时候会带来很多问题

- 集群下, 如果某个 key 太大,会导致数据迁移卡顿
- 在内存分配上,如果一个 key很大,那么当它需要扩容时,会一次性申请更大的一块内存,也会导致卡顿
- 如果这个大 key 被删除,内存会被一次性回收,也会产生

简而言之就是

- 迁移卡
- 扩容卡
- 回收卡

#### 系统出现大 key 的症状

- Redis 内存大起大落,很有可能是大 key 导致的这个时候就得具体定位是哪个 key

#### 定位大 key 

```
redis-cli --bigkeys 
```

如果你担心指令会大幅抬升 Redis Ops ,导致线上报警,还可以加一个休眠参数

```
redis-cli -h 127.0.0.1 -p 7001 --bigkeys -i 0.1

```

每隔 100 条 scan 会休眠 0.1s , ops (operation per second ) 不会大幅度抬升



