##  查询缓存

MySQL 内部自带了一个缓存模块。

缓存的作用我们应该很清楚了，把数据以 KV 的形式放到内存里面，可以加快数据的读取速度，也可以减少服务器处理的时间。但是 MySQL 的缓存我们好像比较陌生，从来 没有去配置过，也不知道它什么时候生效?

比如 user_innodb 有 500 万行数据，没有索引。

#### MySQL 的缓存默认是关闭的。

```sql
show variables like 'query_cache%';
```

![image-20200315125004003](assets/image-20200315125004003.png)

默认关闭的意思就是不推荐使用，为什么 MySQL 不推荐使用它自带的缓存呢?

- 主要是因为 MySQL 自带的缓存的应用场景有限，第一个是它要求 SQL 语句必须一 模一样，中间多一个空格，字母大小写不同都被认为是不同的的 SQL。

- 第二个是表里面任何一条数据发生变化的时候，这张表所有缓存都会失效，所以对 于有大量数据更新的应用，也不适合。

所以缓存这一块，我们还是交给 ORM 框架(比如 MyBatis 默认开启了一级缓存)， 或者独立的缓存服务，比如 Redis 来处理更合适。

在`MySQL 8.0` 中，查询缓存已经被移除了。

## 关闭 MySQL 查询缓存

- `query_cache_size` 设置为 0
- `query_cache_type`设置为 OFF