# 存储引擎

[TOC]

## 存储引擎的选择

- 查询插入操作多的业务表，用 MyISAM
- 临时数据用 Memeroy。
- 常规的并发大更新多的表用 InnoDB。

## 分区或者分表

分区不推荐。

交易历史表:在年底为下一年度建立 12 个分区，每个月一个分区。 

渠道交易表:分成当日表;当月表;历史表，历史表再做分区。

##  字段定义

原则:使用可以正确存储数据的最小数据类型。

为每一列选择合适的字段类型:

### 整数类型

- INT 有 8 种类型，不同的类型的最大存储范围是不一样的。

### 字符类型

- 变长情况下，varchar 更节省空间，但是对于 varchar 字段，需要一个字节来记录长 度。
- 固定长度的用 char，不要用 varchar。

### 非空

非空字段尽量定义成 NOT NULL，提供默认值，或者使用特殊值、空串代替 null。
NULL 类型的存储、优化、使用都会存在问题。

### 不要用外键、触发器、视图

- 降低了可读性;
- 影响数据库性能，应该把把计算的事情交给程序，数据库专心做存储;
- 数据的完整性应该在程序中检查。

### 表拆分

将不常用的字段拆分出去，避免列数过多和数据量过大。

比如在业务系统中，要记录所有接收和发送的消息，这个消息是 XML 格式的，用 blob 或者 text 存储，用来追踪和判断重复，可以建立一张表专门用来存储报文。