# 直接内存 (Direct Memory)

直接内存(Direct Memory) 并不是虚拟机运行时数据区的一部分,也不是 Java 虚拟机规范中定义的内存区域

#### 是什么

JDK1.4 中新加入了 NIO (New Input/Output) 类, 引入了一种 **基于通道(Channel)与缓冲区(Buffer)的 IO方式**

- 可以通过 Native 方法直接分配堆外内存
- 通过一个存储在 Java 堆中的 DirectByteBuffer 对象作为这块内存的引用进行操作
- 由于可以避免 Java 堆和 Native 堆之间来回复制数据,因此在 **某些场景**中可以提高性能

#### 溢出的可能性 OOM

- 机器直接内存的分配不会受堆Java 堆大小的限制
- 但是机器的总内存(RAM 以及 SWAP 区 或者分页文件)的大小以及处理器寻址空间的限制, 服务器管理员在配置虚拟机参数的时候,会根据实际内存 -Xmx 设置堆内存的最大大小,但是经常会忽略掉直接内存

- 当各个内存区域总和大于物理内存限制的时候,会导致动态拓展时出现 OOM

