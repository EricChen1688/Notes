# 方法区

方法区(Method Area)  与 Java 堆一样,是各个线程共享的内存区域

![img](assets/1671546-20190427141310333-343604547.png)

#### 是什么?

方法区(Method Area)与 Java 堆一样,是各个线程共享的内存区域,它用于存储

- 已经被虚拟机加载的类信息
- 常量
- 静态变量
- 即时编译器编译后的代码等数据



> JVM has a method area common across all the threads. It contains per-class elements like constant pool, fields, method local data, method code, constructor codes etc. which are used in class and initialization of objects/interfaces.



> This method area gets created during JVM start-up. It is generally part of Heap area. It could be of fixed size or vary. Its memory may not be contiguous. JVM implementation can give control to programmer over Method area creation, its sizing etc. If method area memory is not sufficient to satisfy an allocation request then JVM throws OutOfMemoryError.



#### 有什么用?

线程之间共享,主要用于存储

- 已经被虚拟机加载的类信息,常量,静态变量
- 即时编译器编译后的代码等数据

#### 值得注意的是

- 根据 Java 虚拟机规范,当方法区无法满足内存分配需求时,会抛出 OutOfMemoryError 异常

## 运行时常量池

运行时常量池是方法区的一部分,

Class 文件中除了有类的版本,字段,方法,接口等描述信息之外,

还有一项信息时常量池,用于存放编译期间生成的各种**字面量**和**符号引用** , 这部分内容将在类加载后进入方法区的运行时常量池中存放

**值的注意的是**

- Java 虚拟机对 Class 文件的一部分(包括常量池)的格式都有严格规定,每一个字节用于存储哪种数据都必须符合规范上的要求才会被虚拟机认可,装载,运行

- Java 虚拟机对于运行时常量池没有做任何细节上的要求,不同的提供商可以按需定制
- 一般来说,除了保存Class 文件中描述的符号引用外,还会把翻译出来的直接引用也存储在运行时常量池

运行时常量池对于 Class 文件常量池的另一个重要特征是具备动态性,Java语言并不要求常量一定只有编译器才能产生,也就是并非阈值入 Class 文件中常量池的内容才能进入方法区运行时常量池,运行期间也可以放心的常量入池

这种特性被开发人员利用的比较多的就是 String类的 Intern()方法



