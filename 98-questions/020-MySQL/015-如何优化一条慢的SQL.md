# [QA]如何优化一条慢的SQL

针对 SQL 的优化 , 不应该只说添加索引

- 表设计层面, 数据类型的选择是否合理
- 大表碎片的整理是否完善
- 表的统计信息是不是准确
- 审查表的执行计划, 判断字段上面有没有合适的索引
- 针对索引的选择性,建立合适的索引, (这里又涉及到大表的 DDL 操作问题)

## SQL

- 查询语句中不要使用select *

  >  因为无法使用到聚集索引

- 尽量减少子查询，使用关联查询(left join,right join,inner join)替代

  > 执行子查询时，MYSQL需要创建临时表，查询完毕后再删除这些临时表，所以，子查询的速度会受到一定的影响，这里多了一个创建和销毁临时表的过程。

- 减少使用IN或者NOT IN ,使用exists，not exists或者关联查询语句替代

- or 的查询尽量用 union或者union all 代替(在确认没有重复数据或者不用剔除重复数据时，union all会更好)

- 应尽量避免在 where 子句中使用!=或<>操作符，否则将引擎放弃使用索引而进行全表扫描。

- 应尽量避免在 where 子句中对字段进行 null 值判断，否则将导致引擎放弃使用索引而进行全表扫描，如: select id from t where num is null 可以在num上设置默认值0，确保表中num列没有null 值，然后这样查询: select id from t where num=0