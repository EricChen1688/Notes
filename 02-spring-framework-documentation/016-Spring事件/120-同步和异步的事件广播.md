# 120-同步和异步的事件广播

[TOC]

## 实现同步异步执行的方式

- 基于实现实现
- 基于注解实现

### 基于实现类 - org.springframework.context.event.SimpleApplicationEventMulticaster

- 模式切换 : setTaskExecutor(@Nullable Executor taskExecutor)
  - 默认模式: 同步 ,taskExecutor = null
  - 异步模式 : 如java.util.concurrent.ThreadPoolExecutor
- 设计缺陷 : 非基于接口契约编程,必须要强转成SimpleApplicationEventMulticaster 以后才能进行切换

### 基于注解- org.springframework.context.event.EventListener

- 模式切换-
  - 默认模式: 同步
  - 异步模式 : 标注 @org.springframework.scheduling.annotation.Async

- 实现限制: 无法直接实现同步/异步动态切换



## Spring同步和异步事件处理的使用场景

- Spring同步事件-绝大多数的Spring使用场景,如ContextRefreshedEvent
- Spring异步事件-主要@EventListener 与 @Asyc配合实现异步处理,不阻塞主线程,比如长时间的数据计算任务等等
  - 不要轻易调整SimpleApplicationEventMulticaster中关联的taskExecutor对象,除非你非常了解Spring事件机制,不然很容易出错

## 代码实例





