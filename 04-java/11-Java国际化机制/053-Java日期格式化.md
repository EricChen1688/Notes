# 053-Java日期格式化

[TOC]

**Version note:** This Date and Time section uses the date and time APIs in the `java.util` package. The `java.time` APIs, available in the JDK 8 release, provides a comprehensive date and time model that offers significant improvements over the `java.util` classes. The `java.time` APIs are described in the [Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html) trail. The [Legacy Date-Time Code](https://docs.oracle.com/javase/tutorial/datetime/iso/legacy.html) page might be of particular interest.

------

This section focuses on the `DateFormat`, `SimpleDateFormat`, and `DateFormatSymbols` classes.

## 预定义格式化器

The [`DateFormat`](https://docs.oracle.com/javase/8/docs/api/java/text/DateFormat.html) class allows you to format dates and times with predefined styles in a locale-sensitive manner. The sections that follow demonstrate how to use the `DateFormat` class with a program called [`DateFormatDemo.java`](https://docs.oracle.com/javase/tutorial/i18n/format/examples/DateFormatDemo.java).

### Dates

Formatting dates with the `DateFormat` class is a two-step process. First, you create a formatter with the `getDateInstance` method. Second, you invoke the `format` method, which returns a `String` containing the formatted date. The following example formats today's date by calling these two methods:

```
Date today;
String dateOut;
DateFormat dateFormatter;

dateFormatter = DateFormat.getDateInstance(DateFormat.DEFAULT, currentLocale);
today = new Date();
dateOut = dateFormatter.format(today);

System.out.println(dateOut + " " + currentLocale.toString());
```

The output generated by this code follows. Notice that the formats of the dates vary with `Locale`. Since `DateFormat` is locale-sensitive, it takes care of the formatting details for each `Locale`.

```
30 juin 2009     fr_FR
30.06.2009       de_DE
Jun 30, 2009     en_US
```

The preceding code example specified the `DEFAULT` formatting style. The `DEFAULT` style is just one of the predefined formatting styles that the `DateFormat` class provides, as follows:

- DEFAULT
- SHORT
- MEDIUM
- LONG
- FULL

The following table shows how dates are formatted for each style with the U.S. and French locales:

| Style     | U.S. Locale            | French Locale      |
| --------- | ---------------------- | ------------------ |
| `DEFAULT` | Jun 30, 2009           | 30 juin 2009       |
| `SHORT`   | 6/30/09                | 30/06/09           |
| `MEDIUM`  | Jun 30, 2009           | 30 juin 2009       |
| `LONG`    | June 30, 2009          | 30 juin 2009       |
| `FULL`    | Tuesday, June 30, 2009 | mardi 30 juin 2009 |

### Times

`Date` objects represent both dates and times. Formatting times with the `DateFormat` class is similar to formatting dates, except that you create the formatter with the `getTimeInstance` method, as follows:

```
DateFormat timeFormatter =
    DateFormat.getTimeInstance(DateFormat.DEFAULT, currentLocale);
```

The table that follows shows the various predefined format styles for the U.S. and German locales:

| Style     | U.S. Locale    | German Locale |
| --------- | -------------- | ------------- |
| `DEFAULT` | 7:03:47 AM     | 7:03:47       |
| `SHORT`   | 7:03 AM        | 07:03         |
| `MEDIUM`  | 7:03:47 AM     | 07:03:07      |
| `LONG`    | 7:03:47 AM PDT | 07:03:45 PDT  |
| `FULL`    | 7:03:47 AM PDT | 7.03 Uhr PDT  |

### Both Dates and Times

To display a date and time in the same `String`, create the formatter with the `getDateTimeInstance` method. The first parameter is the date style, and the second is the time style. The third parameter is the `Locale` . Here's a quick example:

```
DateFormat formatter = DateFormat.getDateTimeInstance(
                           DateFormat.LONG, 
                           DateFormat.LONG, 
                           currentLocale);
```

The following table shows the date and time formatting styles for the U.S. and French locales:

| Style     | U.S. Locale                           | French Locale                  |
| --------- | ------------------------------------- | ------------------------------ |
| `DEFAULT` | Jun 30, 2009 7:03:47 AM               | 30 juin 2009 07:03:47          |
| `SHORT`   | 6/30/09 7:03 AM                       | 30/06/09 07:03                 |
| `MEDIUM`  | Jun 30, 2009 7:03:47 AM               | 30 juin 2009 07:03:47          |
| `LONG`    | June 30, 2009 7:03:47 AM PDT          | 30 juin 2009 07:03:47 PDT      |
| `FULL`    | Tuesday, June 30, 2009 7:03:47 AM PDT | mardi 30 juin 2009 07 h 03 PDT |

## 自定义格式

The previous section, [Using Predefined Formats](https://docs.oracle.com/javase/tutorial/i18n/format/dateFormat.html), described the formatting styles provided by the `DateFormat` class. In most cases these predefined formats are adequate. However, if you want to create your own customized formats, you can use the [`SimpleDateFormat`](https://docs.oracle.com/javase/8/docs/api/java/text/SimpleDateFormat.html) class.

The code examples that follow demonstrate the methods of the `SimpleDateFormat` class. You can find the full source code for the examples in the file named [`SimpleDateFormatDemo`](https://docs.oracle.com/javase/tutorial/i18n/format/examples/SimpleDateFormatDemo.java).

### About Patterns

When you create a `SimpleDateFormat` object, you specify a pattern `String`. The contents of the pattern `String` determine the format of the date and time. For a full description of the pattern's syntax, see the tables in [Date Format Pattern Syntax](https://docs.oracle.com/javase/tutorial/i18n/format/simpleDateFormat.html#datepattern).

The following code formats a date and time according to the pattern `String` passed to the `SimpleDateFormat` constructor. The `String` returned by the `format` method contains the formatted date and time that are to be displayed.

```
Date today;
String output;
SimpleDateFormat formatter;

formatter = new SimpleDateFormat(pattern, currentLocale);
today = new Date();
output = formatter.format(today);
System.out.println(pattern + " " + output);
```

The following table shows the output generated by the previous code example when the U.S. `Locale` is specified:

| Pattern                      | Output                        |
| ---------------------------- | ----------------------------- |
| dd.MM.yy                     | 30.06.09                      |
| yyyy.MM.dd G 'at' hh:mm:ss z | 2009.06.30 AD at 08:29:36 PDT |
| EEE, MMM d, ''yy             | Tue, Jun 30, '09              |
| h:mm a                       | 8:29 PM                       |
| H:mm                         | 8:29                          |
| H:mm:ss:SSS                  | 8:28:36:249                   |
| K:mm a,z                     | 8:29 AM,PDT                   |
| yyyy.MMMMM.dd GGG hh:mm aaa  | 2009.June.30 AD 08:29 AM      |

### Patterns and Locale

The `SimpleDateFormat` class is locale-sensitive. If you instantiate `SimpleDateFormat` without a `Locale` parameter, it will format the date and time according to the default `Locale`. Both the pattern and the `Locale` determine the format. For the same pattern, `SimpleDateFormat` may format a date and time differently if the `Locale` varies.

In the example code that follows, the pattern is hardcoded in the statement that creates the `SimpleDateFormat` object:

```
Date today;
String result;
SimpleDateFormat formatter;

formatter = new SimpleDateFormat("EEE d MMM yy", currentLocale);
today = new Date();
result = formatter.format(today);
System.out.println("Locale: " + currentLocale.toString());
System.out.println("Result: " + result);
```

When the `currentLocale` is set to different values, the preceding code example generates this output:

```
Locale: fr_FR
Result: mar. 30 juin 09
Locale: de_DE
Result: Di 30 Jun 09
Locale: en_US
Result: Tue 30 Jun 09
```



### Date Format Pattern Syntax

You can design your own format patterns for dates and times from the list of symbols in the following table:

| Symbol | Meaning              | Presentation  | Example               |
| ------ | -------------------- | ------------- | --------------------- |
| G      | era designator       | Text          | AD                    |
| y      | year                 | Number        | 2009                  |
| M      | month in year        | Text & Number | July & 07             |
| d      | day in month         | Number        | 10                    |
| h      | hour in am/pm (1-12) | Number        | 12                    |
| H      | hour in day (0-23)   | Number        | 0                     |
| m      | minute in hour       | Number        | 30                    |
| s      | second in minute     | Number        | 55                    |
| S      | millisecond          | Number        | 978                   |
| E      | day in week          | Text          | Tuesday               |
| D      | day in year          | Number        | 189                   |
| F      | day of week in month | Number        | 2 (2nd Wed in July)   |
| w      | week in year         | Number        | 27                    |
| W      | week in month        | Number        | 2                     |
| a      | am/pm marker         | Text          | PM                    |
| k      | hour in day (1-24)   | Number        | 24                    |
| K      | hour in am/pm (0-11) | Number        | 0                     |
| z      | time zone            | Text          | Pacific Standard Time |
| '      | escape for text      | Delimiter     | (none)                |
| '      | single quote         | Literal       | '                     |

Characters that are not letters are treated as quoted text. That is, they will appear in the formatted text even if they are not enclosed within single quotes.

The number of symbol letters you specify also determines the format. For example, if the "zz" pattern results in "PDT," then the "zzzz" pattern generates "Pacific Daylight Time." The following table summarizes these rules:

| Presentation  | Number of Symbols                    | Result                                                       |
| ------------- | ------------------------------------ | ------------------------------------------------------------ |
| Text          | 1 - 3                                | abbreviated form, if one exists                              |
| Text          | >= 4                                 | full form                                                    |
| Number        | minimum number of digits is required | shorter numbers are padded with zeros (for a year, if the count of 'y' is 2, then the year is truncated to 2 digits) |
| Text & Number | 1 - 2                                | number form                                                  |
| Text & Number | 3                                    | text form                                                    |

## 更改日期格式符号

The `format` method of the `SimpleDateFormat` class returns a `String` composed of digits and symbols. For example, in the `String` "Friday, April 10, 2009," the symbols are "Friday" and "April." If the symbols encapsulated in `SimpleDateFormat` don't meet your needs, you can change them with the [`DateFormatSymbols`](https://docs.oracle.com/javase/8/docs/api/java/text/DateFormatSymbols.html). You can change symbols that represent names for months, days of the week, and time zones, among others. The following table lists the `DateFormatSymbols` methods that allow you to modify the symbols:

| Setter Method      | Example of a Symbol the Method Modifies |
| ------------------ | --------------------------------------- |
| `setAmPmStrings`   | PM                                      |
| `setEras`          | AD                                      |
| `setMonths`        | December                                |
| `setShortMonths`   | Dec                                     |
| `setShortWeekdays` | Tue                                     |
| `setWeekdays`      | Tuesday                                 |
| `setZoneStrings`   | PST                                     |

The following example invokes `setShortWeekdays` to change the short names of the days of the week from lowercase to uppercase characters. The full source code for this example is in [`DateFormatSymbolsDemo`](https://docs.oracle.com/javase/tutorial/i18n/format/examples/DateFormatSymbolsDemo.java). The first element in the array argument of `setShortWeekdays` is a null `String`. Therefore the array is one-based rather than zero-based. The `SimpleDateFormat` constructor accepts the modified `DateFormatSymbols` object as an argument. Here is the source code:

```
Date today;
String result;
SimpleDateFormat formatter;
DateFormatSymbols symbols;
String[] defaultDays;
String[] modifiedDays;

symbols = new DateFormatSymbols( new Locale("en", "US"));
defaultDays = symbols.getShortWeekdays();

for (int i = 0; i < defaultDays.length; i++) {
    System.out.print(defaultDays[i] + " ");
}
System.out.println();

String[] capitalDays = {
    "", "SUN", "MON",
    "TUE", "WED", "THU",
    "FRI", "SAT"
};
symbols.setShortWeekdays(capitalDays);

modifiedDays = symbols.getShortWeekdays();
for (int i = 0; i < modifiedDays.length; i++) {
    System.out.print(modifiedDays[i] + " ");
}
System.out.println();
System.out.println();

formatter = new SimpleDateFormat("E", symbols);
today = new Date();
result = formatter.format(today);
System.out.println("Today's day of the week: " + result);
```

The preceding code generates this output:

```
 Sun Mon Tue Wed Thu Fri Sat 
 SUN MON TUE WED THU FRI SAT 

Today's day of the week: MON
```