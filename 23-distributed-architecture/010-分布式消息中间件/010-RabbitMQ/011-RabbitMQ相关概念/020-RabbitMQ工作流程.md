# 020-RabbitMQ工作流程

## 消息中间件流程

生产者将消息存入RabbitMQ Broker，以及消费者从Broker中消费数据的整个流程。

<img src="../../../../assets/image-20201130125444888.png" alt="image-20201130125444888" style="zoom:50%;" />

- 首先生产者将业务方数据进行可能的包装，之后封装成消息，发送（AMQP协议里这个动作对应的命令为**Basic.Publish**）到Broker中。

- 消费者订阅并接收消息（AMQP协议里这个动作对应的命令为**Basic.Consume**或者**Basic.Get**），经过可能的解包处理得到原始的数据，之后再进行业务处理逻辑。
  - 这个业务处理逻辑并不一定需要和接收消息的逻辑使用同一个线程。
  - 消费者进程可以使用一个线程去接收消息，存入到内存中，比如使用Java中的BlockingQueue。
  - 业务处理逻辑使用另一个线程从内存中读取数据，这样可以将应用进一步解耦，提高整个应用的处理效率。

## 